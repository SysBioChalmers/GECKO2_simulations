# GECKO2_simulations

Collection of scripts for reproduction of simulation results in "[Reconstruction of a catalogue of genome-scale metabolic models with enzymatic constraints using GECKO 2.0](https://www.biorxiv.org/content/10.1101/2021.03.05.433259v1)".

## Required Software
* A functional Matlab installation (MATLAB 7.3 or higher). 
* The [COBRA toolbox for MATLAB](https://github.com/opencobra/cobratoolbox).
* Both of the previous Matlab requirements.
* The [RAVEN toolbox for MATLAB](https://github.com/SysBioChalmers/RAVEN).
* R studio with R version 3.3.3 or higher
* [Gurobi Optimizer](http://www.gurobi.com/registration/download-reg) for any simulations.

 
## Instructions

Run MATLAB script setup_simulations.m, available at: code/setup_simulations.m. This script will download the necessary repositories (ecModels, GECKO and source GEMs) to construct protein constrained models and run comparative flux variability analysis.

### Figure 1
* Figures 1A and 1B are taken from R markdown "global kcat analysis" available at: 
* Run MATLAB script get_ecModel_Kcats.m, available at: code/GECKO_versions_comparison/
* Figure 1C is generated by running R script getKcatViolinPlots , available at: code/GECKO_versions_comparison/ 
* Figures 1D-F are generated by running R script getecModelKcatsCumDist.R, available at: code/GECKO_versions_comparison/ 
* Figure 1G is generated by running MATLAB script Csources_simulations.m, available at: code/GECKO_versions_comparison/ 

### Figure 2
* Figure 2A is generated by MATLAB script code/Ecoli_batchGrowth/Csources_simulations.m
* Figure 2B is generated by R script code/Ecoli_batchGrowth/Ptot_comparison.R

### Figure 3
* All plots in figure 3 are generated by running MATLAB script code/comparative_FVA/run_comparative_FVA_ecModels.m. These scripts also generate all the necessary data for supplementary file 3.

Protein-constrained ecModels for all the studied conditions and organisms are generated by the MATLAB script code/get_prot_models.m. The resulting ecModels and output files are already available in the folder GECKO2_simulations/ecModels/.

### Figure 4, S1, S2 and S3
* All plots in figure S1 are generated by running MATLAB script code/analyse_protModels/eval_protModels.m
* Figures 4A-C are generated by R script: code/analyse_protModels/analyze_exchFluxes_protModels.R
* Figures S2 A-C, are generated by R script: code/analyse_protModels/compareFluxDist_GEM_ecModels.R
* Figures S2 D-F are generated by R script: code/analyse_protModels/flux_enz_dist_PCA.R
* Figures 4D, 4F and Figures S2 G-I, are generated by R script: code/analyse_protModels/compareProtAllocation.R
* Figure 4E, is generated by R script: code/analyse_protModels/analyze_pathwayUsage.R
* FIgures S3B and S3C are generated by R script: code/analyse_protModels/analyzeOGsAbsEnz.R


All generated plots are stored in the results folder, indicating the figure that they belong to in the subdfolder name.